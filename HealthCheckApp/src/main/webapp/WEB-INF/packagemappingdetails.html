<!DOCTYPE html>
<html>
<head>

<link rel="icon" type="image/png" href="images/logo.png" sizes="32x32">
    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,700,500,500italic,400italic,700italic,900,900italic,300italic,300,100italic,100' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    
    

<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script> -->
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<link rel="stylesheet" type="text/css"
href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css" />



<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

	<script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
    
	<link href="https://cdn.rawgit.com/davidstutz/bootstrap-multiselect/master/dist/css/bootstrap-multiselect.css"
  	    rel="stylesheet" type="text/css" />
	<script src="https://cdn.rawgit.com/davidstutz/bootstrap-multiselect/master/dist/js/bootstrap-multiselect.js"
    	type="text/javascript"></script>
    
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script> -->
    
 <style>
 
	body {font-family: "Lato", sans-serif;}
	
	.modal-dialog1 {
	    margin: 30px 30px auto !important;
	    width: inherit !important;
	}
	
	#tesNameDiv {
    	float: left;
	}
	
	#dropDownHide {
	    float: left;
	}
	#addButtonDiv {
	    float: left;
	}
	
	#btnTrigger
	{
	display:none;
	}
	
	
	.tablink {
	    background-color: #555;
	    color: white;
	    float: left;
	    border: none;
	    outline: none;
	    cursor: pointer;
	    padding: 14px 16px;
	    font-size: 17px;
	    width: 25%;
	}
	
	.tablink:hover {
	    background-color: #777;
	}
	
	body {margin:0;}
	
	.navbar {
	  overflow: hidden;
	  background-color: #33;
	  position: fixed;
	  top: 0;
	  width: 100%;
	}
	
	.navbar a {
	  float: left;
	  display: block;
	  color: #f2f2f2;
	  text-align: center;
	  padding: 14px 16px;
	  text-decoration: none;
	  font-size: 17px;
	}
	
	.main {
	  padding: 16px;
	  margin-top: 30px;
	  height: 1500px; /* Used in this example to enable scrolling */
	}
	
	.header {
	  position: fixed;
	  top: 60px;
	  left: 0;
	  width: 100%;
	  height: 48px;
	  z-index: 10;
	  background: black;
	  -webkit-box-shadow: 0 7px 8px rgba(0, 0, 0, 0.12);
	  -moz-box-shadow: 0 7px 8px rgba(0, 0, 0, 0.12);
	  box-shadow: 0 7px 8px rgba(0, 0, 0, 0.12);
	}
	
	.titleheader {
	  position: fixed;
	  top: 0;
	  left: 0;
	  width: 100%;
	  height: 60px;
	  z-index: 10;
	  background: white;
	  -webkit-box-shadow: 0 7px 8px rgba(0, 0, 0, 0.12);
	  -moz-box-shadow: 0 7px 8px rgba(0, 0, 0, 0.12);
	  box-shadow: 0 7px 8px rgba(0, 0, 0, 0.12);
	}
	
	.titleheaderlogout {
	  position: fixed;
	  top: 0;
	  left: 90%;
	  width: 100%;
	  height: 60px;
	  z-index: 10;
	  background: white;
	  -webkit-box-shadow: 0 7px 8px rgba(0, 0, 0, 0.12);
	  -moz-box-shadow: 0 7px 8px rgba(0, 0, 0, 0.12);
	  box-shadow: 0 7px 8px rgba(0, 0, 0, 0.12);
	}
	
</style>
    

<meta charset="ISO-8859-1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Test Parameter</title>
</head>
<body>
		
	<div class="titleheader">
	
		<div style="float:left; width:90%;"><h3 align="center">Medmantra Health Check Data Entry</h3></div>
		<div class="titleheaderlogout" style="float:right; width:10%;" ><h3 align="center" id="logoutButton">Logout</h3></div>
	
	</div>
	
	<br><br>
	<div class="header">
	<!-- <div class="navbar"> -->
	    <input class="tablink" type="button" id="testParameterDetailsId" value="Test Parameter">
		<input class="tablink" type="button" id="testDetailsId" value="Test Details">
		<input class="tablink" type="button" id="packageDetailsId" value="Package Details">
		<input class="tablink" type="button" id="packageMappingId" value="Package Mapping">
	</div>
	
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
				
		<div>
					 	&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
					 	Customer Package:&nbsp&nbsp
					 	<select id="add_packages_list_tag" name="testParameterList" style="width:100px; height: 25px">
						</select>
						
						&nbsp&nbsp&nbsp&nbsp
						Location:&nbsp&nbsp
					 	<select id="add_location_list_tag" name="locationList" style="width:100px; height: 25px">
						</select>
		</div>
		<br>
		<br>
		<div>	
						&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
						Medmantra Packages: &nbsp&nbsp
						<select id="add_sub_packages_list_tag" multiple="multiple"  name="subParameterList" style="width:250px; height: 30px">
						</select>
						
						&nbsp&nbsp&nbsp&nbsp&nbsp
						<input class="button" type="button" id="buttonShow" value=" Show " data-toggle="modal" data-target="#mymodal3">
						
		</div>
		<br>
		<br>
		
		<br>
		
		<div id="my-table-book" class="table-responsive">
			<h3>&nbsp&nbspList Of Package Mapping</h3>
			<br>
				  <table id="testli" class="table table-striped" style="width: 100%">
						   <thead>
						    <tr>
						     <th>Id</th>
						     <th>Package Name</th>	
						     <th>Medmantra Package Names</th>
						     <th>Location Name</th>
						     <th>Date</th>
						     <th>Medmantra Packages Id's</th>
						     <th>Location Id</th>
						     <th></th>
						     <th></th>
						    </tr>
						   </thead>
						
						   <!-- <tfoot>
						    <tr>
						     <th>Id</th> 
						     <th>Test Name</th>
						     <th>Test Parameters</th>
						     <th>Edit</th>
						     <th>Delete</th>
						    </tr>
						   </tfoot> -->
				  </table>
		<br>
		<br>
		</div>
	
	<div>
		<div class="modal fade" id="mymodal1" role="dialog">
        <div class="modal-dialog1">
          <div class="modal-content">
                
                <!-- For form popup -->

            <form class="form-horizontal color" method="post">
              <div class="modal-header">
                <button type="button" class="close" id="close" data-dismiss="modal">
                  &times;
                </button>
                <h3 class="modal-title">Edit Package Mapping</h3>
              </div>
              <div class="modal-body">
                     <!--  Customer Package:&nbsp&nbsp&nbsp
					  <select id="update_packages_list_tag" name="testParameterList" style="width:30px; height: 25px"></select> -->
					  
					  <div>
					   	  &nbsp&nbsp&nbsp
						  Customer Package:	&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
						  <input type="text" id="selectCustomerPackageUpdate" name="selectCustomerPackageUpdate" style="width: 40%" readonly>
					 	  &nbsp&nbsp&nbsp
						  Location:	<input type="text" id="locationIdUpdate" name="locationIdUpdate" style="width: 35%" readonly>
					  </div>
					  <br>
					  <div>
	                      &nbsp&nbsp&nbsp
	                      Medmantra Packages:&nbsp&nbsp&nbsp
					      <select id="update_sub_packages_list_tag" name="subParameterList" multiple="multiple" style="width:30px; height: 25px"></select>
					      &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
	                      <input class="button" type="button" id="buttonShowUpdate" value=" Show ">
	                  </div>
                      <br>
                      <br>
                      <br>
                      <br>
                    <table id="fullListDataTableUpdate" class="table table-style" style="width: 100%">
						   <thead>
						    <tr>
						     <th>Medmantra Package Name</th>
						     <th>Location Name</th>	
						     <th>Test Inclusion Names</th>
						     <th>Price</th>
						    </tr>
						   </thead>
						
						   <!-- <tfoot>
						    <tr>
						     <th>Medmantra Package Name</th>
						     <th>Location Name</th>	
						     <th>Test Inclusion Names</th>
						     <th>Price</th>
						    </tr>
						   </tfoot> -->
				  <!-- </table> -->
                </table>
                
              </div>
              <div class="modal-footer">
                <div class="form-group">    
                  <div class="col-sm-offset-8 col-sm-3">
                  <div id="book1">
                    <button class="btn btn-brand-blue" id="update">Update</button>
                    </div>
                  </div>
                </div>
              </div>              
            </form>
          <!-- form popup completed -->
          </div> 
        </div>
    </div>
	</div>
	
	
	 <div class="modal fade" id="mymodal2" role="dialog">
        <div class="modal-dialog">
          <div class="modal-content">
            <form class="form-horizontal color" method="post">
              <div class="modal-header">
                <h3 class="modal-title">Delete Package Mapping</h3>
              </div>
              <div class="modal-footer">
	              <div id="book1">
	                    <button class="btn btn-brand-blue" data-dismiss="modal">No</button>
	                    <button class="btn btn-brand-blue" id="delete">Yes</button>
	              </div>
              </div>
        	</form>
           </div>  
        </div>
      </div>
      
		<div class="modal" id="mymodal3" role="dialog">
        <div class="modal-dialog1">
          <div class="modal-content">
            <form class="form-horizontal color" method="post">
              <div class="modal-header">
                <button type="button" class="close" id="close" data-dismiss="modal">
                  &times;
                </button>
                <h3 class="modal-title">Total Medmantra Package details</h3>
              </div>
              <div class="modal-body">
              
			
				  Customer Package:	<input type="text" id="selectCustomerPackageAdd" name="selectCustomerPackageAdd" style="width: 35%" readonly>
				  &nbsp&nbsp&nbsp
				  Location:	<input type="text" id="locationIdAdd" name="locationIdAdd" style="width: 35%" readonly>
				  <br/>
				  <br/>
              
                <table id="fullListDataTable" class="table table-style" style="width: 100%">
                  <!-- <table id="testli" class="table table-striped" style="width: 100%"> -->
						   <thead>
						    <tr>
						     <th>Medmantra Package Name</th>
						     <th>Location Name</th>	
						     <th>Test Inclusion Names</th>
						     <th>Price</th>
						    </tr>
						   </thead>
						
						   <!-- <tfoot>
						    <tr>
						     <th>Medmantra Package Name</th>
						     <th>Location Name</th>	
						     <th>Test Inclusion Names</th>
						     <th>Price</th>
						    </tr>
						   </tfoot> -->
				  <!-- </table> -->
                </table>
              </div>
              <div class="modal-footer">
                <div class="form-group">    
                  <div class="col-sm-offset-8 col-sm-3">
                  <div id="book1">
                    <button class="btn btn-brand-blue" id="confirmAdd">Add</button>
                    </div>
                  </div>
                </div>
              </div>              
            </form>
          </div> 
        </div>
    </div>
    
	
</body>

<script>		
	$(document).ready(function() {
		
		//var URL = "http://220.225.218.37:8080"; // Production
		var URL = "http://13.71.124.208:8081"; // Staging
				
		var selectedPackageValueTemp;
		var selectedPackageTextTemp;
		var selectedMMPackageValueTemp;
		var selectedMMPackageTextTemp;
		var selectedLocationValueTemp;
		var selectedLocationNameTemp;
		
		window.addEventListener( "pageshow", function ( event ) {
		  var historyTraversal = event.persisted || 
		                         ( typeof window.performance != "undefined" && 
		                              window.performance.navigation.type === 2 );
		  if ( historyTraversal ) {
		    window.location.reload();
		  }
		});
		
		$('#dropDownHide').hide();
		//$('#add_sub_packages_list_tag').hide();
		$('#testParameterDetailsId').click(function() {
			window.top.location=URL + "/HealthCheckApp/paramDetails";
		});
		
		$('#testDetailsId').click(function() {
			window.top.location=URL + "/HealthCheckApp/testDetails";
		})
		
		$('#packageDetailsId').click(function() {
			window.top.location=URL + "/HealthCheckApp/packageDetails";
		});
		
		
		tables= $('#testli').DataTable({
			"ajax":{
		        "type": "GET",
		        "url": URL + "/HealthCheckApp/apollo/mapping/list",
		        "dataSrc": function (json) {
		            var return_data = new Array();
		            for(var i=0;i< json.length; i++){
		              return_data.push({
		                'packageId': json[i].packageId,
		                'packageName'  : json[i].packageName,
		                'serviceNamesString' : json[i].serviceNamesString,
		                'packageIdString' : json[i].subPackagesString,
		                'locationId' : json[i].locationId,
		                'locationName' : json[i].locationName,
		                'createdDate' : json[i].createdDate
		              })
		            }
		            return return_data;
		          }
		    },
	        "columns": [{"data":"packageId", width:10},
	                    {"data":"packageName", width:250},
	                    {"data":"serviceNamesString", width:900},
	                    {"data":"locationName", width:150},
	                    {"data":"createdDate", width:300},
	                    {"data":"packageIdString", width:100},
	                    {"data":"locationId", width:70},
	                    {"defaultContent": "<button  class=\"select\" data-toggle=\"modal\" data-target=\"#mymodal2\" data-keyboard=\"false\" data-backdrop=\"static\">Delete</button>", width:60},
                        {"defaultContent": "<button  class=\"select\" data-toggle=\"modal\" data-target=\"#mymodal1\" data-keyboard=\"false\" data-backdrop=\"static\">Edit</button>", width:60}
	                    ]
		});
		
		    $.ajax({
                url : URL + "/HealthCheckApp/apollo/package/list",
			    type : "GET",
			    dataType: "json",
			    
			    error : function() {
			     //alert('error');
			    },
		    	
			    success : function(data) {
						var select = document.getElementById("add_packages_list_tag");
						
						select.options[select.options.length]=new Option("--SELECT--",0);
						
						for(var i=0;i< data.length; i++) {
							id = data[i].packageId;
							name = data[i].packageName;
                            select.options[select.options.length]=new Option(name,id);     
						}
 

						 $('#add_packages_list_tag').multiselect({

		                 	includeSelectAllOption: true,
		                     numberDisplayed: 1,
		                     enableCaseInsensitiveFiltering:true,
		                     nonSelectedText :'Select Package',
		                     maxHeight: 200,
		                     buttonWidth: '20%'
		
		                   });
	            }
			    
  		 });
		    
		     $.ajax({
                url : URL + "/HealthCheckApp/apollo/location/getLocations",
			    type : "GET",
			    dataType: "json",
			    error : function() {
			    },
			    success : function(data) {
						var select = document.getElementById("add_location_list_tag");
						select.options[select.options.length]=new Option("--SELECT--",0);
						for(var i=0;i< data.length; i++) {
							id = data[i].locationId;
							name = data[i].locationName;
                            select.options[select.options.length]=new Option(name,id);     
						}
						 $('#add_location_list_tag').multiselect({								 
                        	includeSelectAllOption: true,
                            numberDisplayed: 1,
                            enableCaseInsensitiveFiltering:true,
                            nonSelectedText :'Select Location',
                            maxHeight: 200,
                            buttonWidth: '25%'
                          });
	            }
  		 });
			    
			    $("#add_location_list_tag").change(function(){
			        var selected = $('#add_location_list_tag option:selected').val();
			        $('#add_sub_packages_list_tag').multiselect('destroy');
			        if (selected > 0) {
			        	$.ajax({
						      type: 'POST',
						      url : URL +  "/HealthCheckApp/apollo/mapping/serviceListByLocationId",
						      data : JSON.stringify({"locationId":selected}),
						      dataType : 'json',
						      contentType: "application/json; charset=utf-8",
						      success : function(data) {
						    		var select = document.getElementById("add_sub_packages_list_tag");
							    	$("#add_sub_packages_list_tag").empty();
							    	//alert(data.length)
									for(var i=0;i< data.length; i++) {
										id = data[i].serviceId;
										name = data[i].serviceName;
			                            select.options[select.options.length]=new Option(name,id);     
									}
									 $('#add_sub_packages_list_tag').multiselect({
			                        	includeSelectAllOption: true,
			                            numberDisplayed: 1,
			                            enableCaseInsensitiveFiltering:true,
			                            nonSelectedText :'Select Medmantra Packages',
			                            maxHeight: 200,
			                            buttonWidth: '25%'
			                          });
									 $("#add_sub_packages_list_tag").multiselect("deselectAll", false);
						      },
						      error:function(){
						    	  window.top.location=URL +  "/HealthCheckApp/mappingDetails";
						      }
						});
					} else {
						/* $('#add_sub_packages_list_tag').multiselect('clearSelection', false); */
						$('#add_sub_packages_list_tag').multiselect('destroy');
					}
			     });
			        
			        /* $.ajax({
		                url : URL + "/HealthCheckApp/apollo/mapping/savePackageMappingByPackageIdAndLocationId",
					    type : "GET",
					    dataType: "json",
					    error : function() {
					     //alert('error');
					    },
					    success : function(data) {
								var select = document.getElementById("add_location_list_tag");
								for(var i=0;i< data.length; i++) {
									id = data[i].locationId;
									name = data[i].locationName;
		                            select.options[select.options.length]=new Option(name,id);     
								}
								 $('#add_location_list_tag').multiselect({			 
		                        	includeSelectAllOption: true,
		                            numberDisplayed: 1,
		                            enableCaseInsensitiveFiltering:true,
		                            nonSelectedText :'Select Location',
		                            maxHeight: 200,
		                            buttonWidth: '17%'
		                          });
			            }    
		  		 }); */
		
		    $('#buttonShow').click(function() {
		    	
		    	var selectedPackage = document.getElementById("add_packages_list_tag").value;
		    	selectedPackageValueTemp = selectedPackage;
		    	selectedPackageTextTemp = $("#add_packages_list_tag :selected").text();
				selectedLocationValueTemp = document.getElementById("add_location_list_tag").value;
				selectedLocationNameTemp = $("#add_location_list_tag :selected").text();

		    	var selectParamString = "";
				if( $('#add_sub_packages_list_tag :selected').length> 0){
				    $('#add_sub_packages_list_tag :selected').each(function(i, selected) {
				    	
				    	if (selectParamString == "") {
				    		selectParamString = $(selected).val();
						} else {
					    	selectParamString +=  "," + $(selected).val();
						}
				    	
					});
				}
				selectedMMPackageValueTemp = selectParamString;
							
				if ($.trim(selectedPackage).length == 0 || selectedPackage == "" || selectedPackage == 0) {
			        alert("Please Select Package Name");
			        return false;
			    } else if ($.trim(selectedLocationValueTemp).length == 0 || selectedLocationValueTemp == "" || selectedLocationValueTemp == 0) {
			    	alert("Please Select Location");
			        return false;
				} else {
					//alert(selectParamString + " : " + selectedLocationValueTemp)
			    	$('#fullListDataTable').DataTable({
			    		  "destroy": true,
			              "searching:": true,
						"ajax":{
					        "type": "POST",
					        "url": URL + "/HealthCheckApp/apollo/mapping/completeList",
						    "contentType": "application/json",
					        "data" : function (data) { return data = JSON.stringify({"subPackagesString":selectParamString,"locationId":selectedLocationValueTemp});},
					        "dataSrc": function (json) {
					            var return_data = new Array();
					            for(var i=0;i< json.length; i++){
					              return_data.push({
					                'serviceName': json[i].serviceName,
					                'locationName'  : json[i].locationName,
					                'testInclusions' : json[i].testInclusions,
					                'price' : json[i].price
					              })
					            }
					            return return_data;
					          }
					    },
				        "columns": [{"data":"serviceName", width:100},
				                    {"data":"locationName", width:100},
				                    {"data":"testInclusions", width:600},
				                    {"data":"price", width:100}
				                    ]
					});
					
					//ResetForm();
				}
				document.getElementById("selectCustomerPackageAdd").value = selectedPackageTextTemp;
				document.getElementById("locationIdAdd").value = selectedLocationNameTemp;
		    	
			});   
	
		    $('#buttonShowUpdate').click(function() {
		    	//alert(LocationIdClick)
		    	var selectParamString = "";
				if( $('#update_sub_packages_list_tag :selected').length> 0){
					debugger;
				    $('#update_sub_packages_list_tag :selected').each(function(i, selected) {
				    	
				    	if (selectParamString == "") {
				    		selectParamString = $(selected).val();
						} else {
					    	selectParamString +=  "," + $(selected).val();
						}
				    	
					});
				}
			    	$('#fullListDataTableUpdate').DataTable({
			    		"destroy": true,
			            "searching:": true,
						"ajax":{
					        "type": "POST",
					        "url": URL + "/HealthCheckApp/apollo/mapping/completeList",
						    "contentType": "application/json",
					        "data" : function (data) { return data = JSON.stringify({"subPackagesString":selectParamString, "locationId":LocationIdClick});},
					        "dataSrc": function (json) {
					            var return_data = new Array();
					            for(var i=0;i< json.length; i++){
					              return_data.push({
					                'serviceName': json[i].serviceName,
					                'locationName'  : json[i].locationName,
					                'testInclusions' : json[i].testInclusions,
					                'price' : json[i].price
					              })
					            }
					            return return_data;
					          }
					    },
				        "columns": [{"data":"serviceName", width:100},
				                    {"data":"locationName", width:100},
				                    {"data":"testInclusions", width:600},
				                    {"data":"price", width:100}
				                    ]
					});
		    	
			});   
		    
		    
		    
	$('#confirmAdd').click(function() {
        	//alert(selectedPackageValueTemp + " : " + selectedMMPackageValueTemp + " : " + selectedLocationValueTemp)
        	$.ajax({
			      type: 'POST',
			      url : URL +  "/HealthCheckApp/apollo/mapping/add",
			      data : JSON.stringify({"packageId":selectedPackageValueTemp,"serviceNamesString":selectedMMPackageValueTemp,"locationId":selectedLocationValueTemp}),
			      dataType : 'json',
			      contentType: "application/json; charset=utf-8",
			      success : function(data) {
			    	  alert(data.response)
			    	  window.top.location=URL +  "/HealthCheckApp/mappingDetails";
			      },
			      error:function(data){
			    	  alert(data.response);
			    	  window.top.location=URL +  "/HealthCheckApp/mappingDetails";
			      }
			});
			//ResetForm();
			
	});
	

    function ResetForm() {
    	$('input[type="text"]').val('');
    	document.getElementById("testDescription").value = "";
            $('#add_sub_packages_list_tag option:selected').each(function() {
                $(this).prop('selected', false);
            })
 
            $('#add_sub_packages_list_tag').multiselect('refresh');
            $('#dropDownHide').hide();
	}

	var table = $('#testli').DataTable();

	$('#testli tbody').on( 'click', 'tr', function () {
	$("#update_sub_packages_list_tag").empty();
		 
	  var data=$(this).text();
	  packageIdClick = $('td', this).eq(0).text();
	  pckageNameClick = $('td', this).eq(1).text();
	  subPackagesClick = $('td', this).eq(2).text();
	  LocationNameClick = $('td', this).eq(3).text();
	  packagesIdListStore = $('td', this).eq(5).text();
	  LocationIdClick = $('td', this).eq(6).text();
	  
	  document.getElementById("selectCustomerPackageUpdate").value = pckageNameClick;
	  document.getElementById("locationIdUpdate").value = LocationNameClick;
	  
	  $.ajax({
	      type: 'POST',
	      url : URL +  "/HealthCheckApp/apollo/mapping/serviceListByLocationId",
	      data : JSON.stringify({"locationId":LocationIdClick}),
	      dataType : 'json',
	      contentType: "application/json; charset=utf-8",
	      success : function(data) {
	    	  	
	    		var select = document.getElementById("update_sub_packages_list_tag");
				for(var i=0;i< data.length; i++) {
					id = data[i].serviceId;
					name = data[i].serviceName;
                   select.options[select.options.length]=new Option(name,id);     
				}
				 $('#update_sub_packages_list_tag').multiselect({
               	   includeSelectAllOption: true,
                   numberDisplayed: 1,
                   enableCaseInsensitiveFiltering:true,
                   nonSelectedText :'Select Medmantra Packages',
                   maxHeight: 200,
                   buttonWidth: '40%'
                 });
				 
				 $("#update_sub_packages_list_tag").multiselect("deselectAll", false);
                 $("#update_sub_packages_list_tag").multiselect("refresh");
                 $("#update_sub_packages_list_tag").multiselect("select", packagesIdListStore.split(','));
	      },
	      error:function(){
	    	  window.top.location=URL +  "/HealthCheckApp/mappingDetails";
	      }
	});
	  
	    $('#fullListDataTableUpdate').DataTable({
			"destroy": true,
	        "searching:": true,
			"ajax":{
		        "type": "POST",
		        "url": URL + "/HealthCheckApp/apollo/mapping/completeList",
			    "contentType": "application/json",
		        "data" : function (data) { return data = JSON.stringify({"subPackagesString":packagesIdListStore,"locationId":LocationIdClick});},
		        "dataSrc": function (json) {
		            var return_data = new Array();
		            for(var i=0;i< json.length; i++){
		              return_data.push({
		                'serviceName': json[i].serviceName,
		                'locationName'  : json[i].locationName,
		                'testInclusions' : json[i].testInclusions,
		                'price' : json[i].price
		              })
		            }
		            return return_data;
		          }
		    },
	        "columns": [{"data":"serviceName", width:100},
	                    {"data":"locationName", width:100},
	                    {"data":"testInclusions", width:600},
	                    {"data":"price", width:100}
	                    ]
		});
	  
	  	   
	});
	
	$('#update').click( function (e) {
		//var selectedPackage = document.getElementById("update_packages_list_tag").value;
		var selectParamString = "";
		if( $('#update_sub_packages_list_tag :selected').length> 0){
		    $('#update_sub_packages_list_tag :selected').each(function(i, selected) {
		    	if (selectParamString == "") {
		    		selectParamString = $(selected).val();
				} else {
			    	selectParamString +=  "," + $(selected).val();
				}
			});
		}
		$.ajax({
			type: 'POST',
			url : URL +  "/HealthCheckApp/apollo/mapping/update",
			data : JSON.stringify({"packageId":packageIdClick,"serviceNamesString":selectParamString,"locationId":LocationIdClick}),
			dataType : 'json',
			contentType: "application/json; charset=utf-8",
			success : function(data) {
				console.log("success");
				window.top.location=URL +  "/HealthCheckApp/mappingDetails";
			},
			error:function(){
				console.log("fail");
				window.top.location=URL +  "/HealthCheckApp/mappingDetails";
			}
		});   
	});
	
	
	$('#delete').click( function (e) {
		//alert(packageIdClick + " : " + LocationIdClick)
		    $.ajax({
		      type: 'POST',
		      url : URL + "/HealthCheckApp/apollo/mapping/delete",
		      data : JSON.stringify({"packageId":packageIdClick,"locationId":LocationIdClick}),
		      dataType : 'json',
		      contentType: "application/json; charset=utf-8",
		      success : function(data)
			     {
		    	  console.log("success");
			      window.top.location=URL + "/HealthCheckApp/mappingDetails";
			      },
			    error:function(){
			    	console.log("fail");
			     window.top.location=URL + "/HealthCheckApp/mappingDetails";
			    }
		    });
		});
	
	$('#logoutButton').click( function (e) {
	    $.ajax({
	      type: 'POST',
	      url : URL + "/HealthCheckApp/apollo/login/logout",
	      data : JSON.stringify({}),
	      dataType : 'json',
	      contentType: "application/json; charset=utf-8",
	      success : function(data) {
		      	window.top.location=URL + "/HealthCheckApp/login.html";
		  },
		  error:function(){
		   		window.top.location=URL + "/HealthCheckApp/mappingDetails";
		  }
	    });
	});
	
	
	});
</script>

</html>